<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Zome Functions - The Holochain Guidebook</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">var path_to_root = "../";</script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = 'light'; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li><a href="../welcome.html"><strong aria-hidden="true">1.</strong> Welcome</a></li><li><ol class="section"><li><a href="../overview.html"><strong aria-hidden="true">1.1.</strong> Overview</a></li><li><a href="../how_to_contribute.html"><strong aria-hidden="true">1.2.</strong> How to contribute</a></li></ol></li><li><a href="../planning_a_dapp.html"><strong aria-hidden="true">2.</strong> Planning a dApp</a></li><li><a href="../building_apps.html"><strong aria-hidden="true">3.</strong> Building Holochain Apps: Intro</a></li><li><ol class="section"><li><a href="../building_for_different_platforms.html"><strong aria-hidden="true">3.1.</strong> Building for Different Platforms</a></li><li><a href="../intro_to_dna_config.html"><strong aria-hidden="true">3.2.</strong> Intro to DNA: Configuration</a></li><li><a href="../intro_to_dna_code.html"><strong aria-hidden="true">3.3.</strong> Intro to DNA: Code</a></li><li><a href="../intro_to_command_line_tools.html"><strong aria-hidden="true">3.4.</strong> Intro to Command Line Tools</a></li><li><a href="../new_project.html"><strong aria-hidden="true">3.5.</strong> Create A New Project</a></li><li><a href="../project_source_folders.html"><strong aria-hidden="true">3.6.</strong> Project Source Folders</a></li><li><a href="../configuring_an_app.html"><strong aria-hidden="true">3.7.</strong> Configuring an App</a></li><li><a href="../zome/rust.html"><strong aria-hidden="true">3.8.</strong> Writing in Rust</a></li><li><a href="../zome/assemblyscript.html"><strong aria-hidden="true">3.9.</strong> Writing in Assemblyscript</a></li><li><a href="../zome/intro_to_webassembly.html"><strong aria-hidden="true">3.10.</strong> Intro to WebAssembly</a></li><li><a href="../alpha_migrate.html"><strong aria-hidden="true">3.11.</strong> Updating to Alpha 2</a></li><li><a href="../built_with_holochain.html"><strong aria-hidden="true">3.12.</strong> Built With Holochain</a></li></ol></li><li><a href="../zome/welcome.html"><strong aria-hidden="true">4.</strong> Building Holochain Apps: Zome Code</a></li><li><ol class="section"><li><a href="../zome/adding_a_zome.html"><strong aria-hidden="true">4.1.</strong> Adding a Zome</a></li><li><a href="../zome/intro_to_hdk.html"><strong aria-hidden="true">4.2.</strong> Intro to HDK</a></li><li><a href="../zome/define_zome.html"><strong aria-hidden="true">4.3.</strong> Intro to Zome Definition</a></li><li><a href="../zome/entry_type_definitions.html"><strong aria-hidden="true">4.4.</strong> App Entry Type Definitions</a></li><li><a href="../zome/genesis.html"><strong aria-hidden="true">4.5.</strong> Genesis</a></li><li><a href="../zome/zome_functions.html" class="active"><strong aria-hidden="true">4.6.</strong> Zome Functions</a></li><li><a href="../zome/capabilities.html"><strong aria-hidden="true">4.7.</strong> Capabilities</a></li><li><a href="../zome/read_and_write.html"><strong aria-hidden="true">4.8.</strong> (E) Read &amp; Write Data Operations</a></li><li><a href="../zome/entry_validation.html"><strong aria-hidden="true">4.9.</strong> (E) Entry Validation</a></li><li><a href="../zome/linking.html"><strong aria-hidden="true">4.10.</strong> (E) Linking</a></li><li><a href="../zome/node_to_node_messages.html"><strong aria-hidden="true">4.11.</strong> (E) Node to Node Messaging</a></li><li><a href="../zome/calling_other_zomes.html"><strong aria-hidden="true">4.12.</strong> (E) Calling Other Zomes</a></li><li><a href="../zome/signatures.html"><strong aria-hidden="true">4.13.</strong> (E) Cryptographic Signatures</a></li><li><a href="../zome/bundling.html"><strong aria-hidden="true">4.14.</strong> (E) Bundling</a></li><li><a href="../zome/emitting_signals.html"><strong aria-hidden="true">4.15.</strong> (E) Emitting Signals</a></li><li><a href="../zome/dna_variables.html"><strong aria-hidden="true">4.16.</strong> API DNA Variables</a></li><li><a href="../zome/api_functions.html"><strong aria-hidden="true">4.17.</strong> List of API Functions</a></li></ol></li><li><a href="../packaging.html"><strong aria-hidden="true">5.</strong> Building Holochain Apps: Packaging</a></li><li><ol class="section"><li><a href="../build_files.html"><strong aria-hidden="true">5.1.</strong> .build Files</a></li><li><a href="../hcignore_files.html"><strong aria-hidden="true">5.2.</strong> .hcignore Files</a></li></ol></li><li><a href="../intro_to_testing.html"><strong aria-hidden="true">6.</strong> Building Holochain Apps: Testing</a></li><li><ol class="section"><li><a href="../running_tests.html"><strong aria-hidden="true">6.1.</strong> Running Tests</a></li><li><a href="../intro_to_holochain_nodejs.html"><strong aria-hidden="true">6.2.</strong> Intro to holochain-nodejs</a></li><li><a href="../testing_configuration.html"><strong aria-hidden="true">6.3.</strong> Configuration</a></li><li><ol class="section"><li><a href="../configuration_alternatives.html"><strong aria-hidden="true">6.3.1.</strong> Configuration Alternatives</a></li></ol></li><li><a href="../scenario_testing.html"><strong aria-hidden="true">6.4.</strong> Scenario Testing</a></li><li><ol class="section"><li><a href="../scenario_testing_setup.html"><strong aria-hidden="true">6.4.1.</strong> Setup</a></li><li><a href="../scenario_testing_running_tape.html"><strong aria-hidden="true">6.4.2.</strong> Running With Tape</a></li><li><a href="../other_test_harnesses.html"><strong aria-hidden="true">6.4.3.</strong> Other Test Harnesses</a></li></ol></li><li><a href="../nodejs_dna_instances.html"><strong aria-hidden="true">6.5.</strong> DNA Instances</a></li><li><ol class="section"><li><a href="../nodejs_calling_zome_functions.html"><strong aria-hidden="true">6.5.1.</strong> Calling Zome Functions</a></li><li><a href="../handling_async.html"><strong aria-hidden="true">6.5.2.</strong> Handle Network Asynchronicity</a></li></ol></li><li><a href="../testing_checking_results.html"><strong aria-hidden="true">6.6.</strong> (E) Checking Results</a></li><li><a href="../managing_the_conductor.html"><strong aria-hidden="true">6.7.</strong> Manually Manage the Conductor</a></li><li><a href="../access_instance_info.html"><strong aria-hidden="true">6.8.</strong> Access Instance Info</a></li></ol></li><li><a href="../conductors.html"><strong aria-hidden="true">7.</strong> Running Holochain Apps: Conductors</a></li><li><ol class="section"><li><a href="../development_conductor.html"><strong aria-hidden="true">7.1.</strong> Development Conductor</a></li><li><ol class="section"><li><a href="../hc_configuring_networking.html"><strong aria-hidden="true">7.1.1.</strong> Configuring Networking</a></li></ol></li><li><a href="../production_conductor.html"><strong aria-hidden="true">7.2.</strong> Production Conductor</a></li><li><ol class="section"><li><a href="../intro_to_toml_config.html"><strong aria-hidden="true">7.2.1.</strong> Intro to TOML Config Files</a></li><li><a href="../conductor_agents.html"><strong aria-hidden="true">7.2.2.</strong> Agents</a></li><li><a href="../conductor_dnas.html"><strong aria-hidden="true">7.2.3.</strong> DNAs</a></li><li><a href="../conductor_instances.html"><strong aria-hidden="true">7.2.4.</strong> Instances</a></li><li><a href="../conductor_interfaces.html"><strong aria-hidden="true">7.2.5.</strong> Interfaces</a></li><li><a href="../conductor_bridges.html"><strong aria-hidden="true">7.2.6.</strong> Bridges</a></li><li><a href="../conductor_ui_bundles.html"><strong aria-hidden="true">7.2.7.</strong> UI Bundles</a></li><li><a href="../conductor_ui_interfaces.html"><strong aria-hidden="true">7.2.8.</strong> UI Interfaces</a></li><li><a href="../conductor_logging.html"><strong aria-hidden="true">7.2.9.</strong> Logging</a></li><li><a href="../conductor_networking.html"><strong aria-hidden="true">7.2.10.</strong> Networking</a></li><li><a href="../conductor_persistence_dir.html"><strong aria-hidden="true">7.2.11.</strong> Persistence Directory</a></li></ol></li><li><a href="../json_rpc_interfaces.html"><strong aria-hidden="true">7.3.</strong> Intro to JSON-RPC Interfaces</a></li><li><a href="../conductor_json_rpc_api.html"><strong aria-hidden="true">7.4.</strong> Conductor JSON-RPC API</a></li><li><ol class="section"><li><a href="../json_rpc_http.html"><strong aria-hidden="true">7.4.1.</strong> HTTP</a></li><li><a href="../json_rpc_websockets.html"><strong aria-hidden="true">7.4.2.</strong> WebSockets</a></li></ol></li><li><a href="../conductor_admin.html"><strong aria-hidden="true">7.5.</strong> Conductor Admin</a></li></ol></li><li><a href="../apps_user_interfaces.html"><strong aria-hidden="true">8.</strong> Building Holochain Apps: User Interfaces</a></li><li><a href="../bridging.html"><strong aria-hidden="true">9.</strong> (E) Building Holochain Apps: Bridging</a></li><li><a href="../live_hc_apps.html"><strong aria-hidden="true">10.</strong> (E) Going Live with Holochain Apps</a></li><li><ol class="section"><li><a href="../creating_versioned_releases.html"><strong aria-hidden="true">10.1.</strong> (E) Creating Versioned Releases</a></li></ol></li><li><a href="../apps_advanced_topics.html"><strong aria-hidden="true">11.</strong> (E) Building Holochain Apps: Advanced Topics</a></li><li><ol class="section"><li><a href="../json_string.html"><strong aria-hidden="true">11.1.</strong> Understanding JsonString</a></li><li><a href="../building_for_android.html"><strong aria-hidden="true">11.2.</strong> Building For Android</a></li></ol></li><li><a href="../extending_holochain.html"><strong aria-hidden="true">12.</strong> (E) Extending Holochain</a></li><li><ol class="section"><li><a href="../embedding_holochain.html"><strong aria-hidden="true">12.1.</strong> (E) Embedding Holochain</a></li><li><ol class="section"><li><a href="../core_api.html"><strong aria-hidden="true">12.1.1.</strong> (E) Core API</a></li></ol></li><li><a href="../naming_conventions.html"><strong aria-hidden="true">12.2.</strong> Naming conventions</a></li><li><a href="../writing_development_kit.html"><strong aria-hidden="true">12.3.</strong> Writing a Development Kit (HDK)</a></li><li><a href="../zome/implementation.html"><strong aria-hidden="true">12.4.</strong> Implementing Zome API functions</a></li><li><a href="../state_actions.html"><strong aria-hidden="true">12.5.</strong> Redux Architecture</a></li><li><ol class="section"><li><a href="../state/actions.html"><strong aria-hidden="true">12.5.1.</strong> State actions</a></li></ol></li><li><a href="../state/actors.html"><strong aria-hidden="true">12.6.</strong> State actors</a></li></ol></li><li><a href="../faq.html"><strong aria-hidden="true">13.</strong> FAQ</a></li><li><a href="../glossary.html"><strong aria-hidden="true">14.</strong> (E) Glossary</a></li><li><ol class="section"><li><a href="../agent.html"><strong aria-hidden="true">14.1.</strong> (E) Agent</a></li><li><a href="../keys.html"><strong aria-hidden="true">14.2.</strong> (E) Keys</a></li><li><a href="../dna.html"><strong aria-hidden="true">14.3.</strong> (E) DNA</a></li><li><a href="../zome.html"><strong aria-hidden="true">14.4.</strong> (E) Zome</a></li><li><a href="../source_chain.html"><strong aria-hidden="true">14.5.</strong> (E) Source Chain</a></li><li><a href="../distributed_hash_table.html"><strong aria-hidden="true">14.6.</strong> Distributed Hash Table</a></li></ol></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light <span class="default">(default)</span></button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                            <a href="https://github.com/holochain/holochain-rust/edit/develop/doc/holochain_101/src/zome/zome_functions.md">
                                <i class="fa fa-edit"></i>
                            </a>
                        </div>

                        <h1 class="menu-title">The Holochain Guidebook</h1>

                        <div class="right-buttons">
                            <a href="../print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="#zome-functions" id="zome-functions"><h1>Zome Functions</h1></a>
<p>It is time to address the core application logic of Zomes.</p>
<p>What Zome functions you write depends, of course, on what you are building your application to do. By exposing a number of native capacities of Holochain to Zomes, developers have been given access to a rich suite of tools that offer limitless ways they can be combined. Holochain achieves this by exposing core functions to the WASM code of Zomes.</p>
<p>A core feature of an HDK is that it will handle that native interface to Holochain, wrapping the underlying functions in easy to call, well defined and well documented functions that are native to the language that you're writing in!</p>
<p>So within Zome code, by calling functions of the HDK, you can do powerful things with Holochain, like:</p>
<ul>
<li>Read and write data to and from the configured storage mechanism, and from the network</li>
<li>Transport messages directly between nodes of a network</li>
<li>Call functions in other Zomes, and even &quot;bridged&quot; DNA instances</li>
<li>Use cryptographic functions like signing and verification to handle data security and integrity</li>
<li>Emit &quot;signals&quot; containing data from a Zome, to a UI for example</li>
</ul>
<p>How these different functions work and how to use them will be covered throughout the rest of this chapter in detail. This article will provide a general overview of what Zome functions themselves are and how they work.</p>
<p>Recall that Zomes will be written in diverse programming languages, any one that compiles to WebAssembly. Towards the bottom of this article, &quot;Building in Rust&quot; gives examples of what writing functions in Rust will be like. It is difficult to show what a function in WASM looks like, since even the &quot;human-readable&quot; version of WASM, WAT, is not highly readable.</p>
<a class="header" href="#dna-zomes-functions-traits-and-capabilities" id="dna-zomes-functions-traits-and-capabilities"><h2>DNA, Zomes, Functions, Traits, and Capabilities</h2></a>
<p>When Holochain loads a DNA file, to start an instance from it, it expects the presence of one or more Zomes in the definition. Here is a skeletal (incomplete) DNA JSON file to illustrate this:</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;test&quot;,
    &quot;zomes&quot;: {
        &quot;test_zome&quot;: {
            &quot;name&quot;: &quot;test_zome&quot;,
            &quot;traits&quot;: {
                &quot;hc_public&quot;: {
                    &quot;functions&quot;: [],
                }
            },
            &quot;fn_declarations&quot;: [],
            &quot;code&quot;: {
                &quot;code&quot;: &quot;AAECAw==&quot;
            }
        }
    }
}
</code></pre>
<p>This theoretical DNA has one Zome, &quot;test_zome&quot;. However, it has no functions. Note that the nested <code>fn_declarations</code> property is an empty array.</p>
<p>There are a few things to learn from this DNA JSON. The first, is that the code, Base64 encoded WASM, is actually embedded in the Zome's definition, nested under <code>code.code</code>. All the functions Holochain expects to be implemented need to be encapsulated within that WASM code.</p>
<p>The second is that even outside of the WASM code, Holochain expects a certain level of visibility into the functions contained within, at least the ones meant to be called via Holochain (as oppose to private/internal functions).</p>
<p>There are at least two reasons for this:</p>
<ul>
<li>to be able to reason about data inputs and outputs for those functions</li>
<li>to group those functions semantically for composition</li>
</ul>
<p>These will both be discussed below.</p>
<a class="header" href="#function-declarations" id="function-declarations"><h2>Function Declarations</h2></a>
<p>All of the Zome's functions are declared in the <code>fn_declarations</code> array. Here is an example of one:</p>
<pre><code class="language-json">&quot;fn_declarations&quot;: [
    {
        &quot;name&quot;: &quot;get_task_list&quot;,
        &quot;inputs&quot;: [{&quot;name&quot;: &quot;username&quot;, &quot;type&quot;: &quot;string&quot;}],
        &quot;outputs&quot;: [{&quot;name&quot;: &quot;task_list&quot;, &quot;type&quot;: &quot;json&quot;}]
    }
]
</code></pre>
<p>Each function declaration is an object that includes the <code>name</code>, and the <code>inputs</code> and <code>outputs</code> expected for the function. Since WebAssembly only compiles from code languages with a type system, the generation of these inputs and outputs can expected to be automated.</p>
<p>The <code>name</code> is the most important thing here, because when a function call to an instance is being performed, it will have to match a name which Holochain can find in the <code>functions</code>. If the function isn't declared, Holochain will treat it as if it doesn't exist, even if it is an exposed function in the WASM code.</p>
<a class="header" href="#traits" id="traits"><h2>Traits</h2></a>
<p>Traits provide a way to group functions by name.  The primary use of this feature is for creating a composibility space where DNA creators can implement different DNAs to emergent function interfaces and then compose with them in the conductor by matching on the function group names and signatures.  Additionally Holochain may reserve a few special trait names that have specific side-effects.  The first of such reserved names is <code>hc_public</code>.  Functions grouped in this name will have automatically added to a public capability grant that happens at genesis time, thus making them accessible to any caller.  For more details on the Holochain security model please see the <a href="capabilities.html">Capabilities</a> section.</p>
<p>Here is an example of what a trait definition using the public reserved trait name might look like:</p>
<pre><code class="language-json">&quot;traits&quot;: {
    &quot;hc_public&quot;: {
        &quot;functions&quot;: [&quot;get_task_list&quot;]
    }
}
</code></pre>
<a class="header" href="#data-interchange---inputs-and-outputs" id="data-interchange---inputs-and-outputs"><h2>Data Interchange - Inputs and Outputs</h2></a>
<p>In order to support building zomes in a variety of languages, we decided to use a simple language agnostic function specification format, using JSON.  Other formats may be supported in the future.</p>
<p>This has two big implications: Holochain Conductor implementations must handle JSON serialization and deserialization on the &quot;outside&quot;, and HDKs and Zomes must handle JSON serialization and deserialization on the &quot;inside&quot;. Holochain agrees only to mediate between the two by passing a string (which should represent valid JSON data).</p>
<a class="header" href="#how-zome-functions-are-called" id="how-zome-functions-are-called"><h2>How Zome Functions Are Called</h2></a>
<p>Function calls are received by Holochain from client requests (which there are a variety of implementations of, discussed later).  When function calls are being made, they will need to include a complete enough set of arguments to know the following:</p>
<ul>
<li>which Zome?</li>
<li>which function?</li>
<li>what values should the function be called with?</li>
</ul>
<p>Before making the function call, Holochain will check the validity of the request, and fail if necessary. If the request is deemed valid, Holochain will mount the WASM code for a Zome using its' WASM interpreter, and then make a function call into it, giving it the arguments given to it in the request. When it receives the response from the WASM, it will then pass that return value as the response to the request. This may sound complex, but that's just what's going on internally, actually using it with an HDK and a <a href="../conductors.html">Conductor</a> (which is discussed later) is easy.</p>
<a class="header" href="#building-in-rust-zome-functions" id="building-in-rust-zome-functions"><h2>Building in Rust: Zome Functions</h2></a>
<p>So far, in <a href="./entry_type_definitions.html">entry type definitions</a> and <a href="./genesis.html">genesis</a>, the most complex example of <code>define_zome!</code> was still very simple, and didn't include any functions:</p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
...

#[derive(Serialize, Deserialize, Debug, DefaultJson)]
struct Post {
    content: String,
    date_created: String,
}

define_zome! {
    entries: [
        entry!(
            name: &quot;post&quot;,
            description: &quot;A blog post entry which has an author&quot;,
            sharing: Sharing::Public,
            native_type: Post,
            validation_package: || {
                ValidationPackageDefinition::Entry
            },
            validation: |_post: Post, _validation_data: ValidationData| {
                Ok(())
            }
        )
    ]

    genesis: || {
        Ok(())
    }

    functions: []
}
#}</code></pre></pre>
<p><code>functions</code> is where the function declarations will be made.</p>
<a class="header" href="#adding-a-zome-function" id="adding-a-zome-function"><h3>Adding a Zome Function</h3></a>
<p>In order to add a Zome function, there are two primary steps that are involved.</p>
<ol>
<li>declare your function in <code>define_zome!</code></li>
<li>write the Rust code for the handler of that function, calling any HDK functions you need</li>
</ol>
<p><strong>Step 1</strong></p>
<p>The <code>functions</code> section looks a bit like an array of key-value pairs:</p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
...

define_zome! {
    ...
    functions: [
        send_message: {
            inputs: |to_agent: Address, message: String|,
            outputs: |response: ZomeApiResult&lt;String&gt;|,
            handler: handle_send_message
        }
    ]
}
#}</code></pre></pre>
<p>In this example, <code>send_message</code> is the given name of this function, by which it will be referenced and called elsewhere. There are three properties necessary to provide <code>send_message</code>, and any function declaration: <code>inputs</code>, <code>outputs</code>, and <code>handler</code>.</p>
<p><code>inputs</code> expects a list or argument names, and types, for the <code>send_message</code> function to be called with.</p>
<p><code>outputs</code> expects a single declaration of a return type. The name (which in the example is <code>response</code>) is arbitrary, call it anything.</p>
<p><code>handler</code> expects the name of a function which will handle this function call, and which matches the function signature of <code>inputs</code> and <code>outputs</code>. In this case, <code>handle_send_message</code>, which has yet to be defined.</p>
<p><strong>Step 2</strong></p>
<p>Here is an example of a simplistic function, for illustration purposes. It centers on the use of a function call to an HDK function.</p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
fn handle_send_message(to_agent: Address, message: String) -&gt; ZomeApiResult&lt;String&gt;  {
    hdk::send(to_agent, message, 60000.into())
}
#}</code></pre></pre>
<p>Notice right away how the arguments match perfectly with the <code>inputs: |...|</code> section of the function declaration. Any differences will cause issues. This is also true of the return type of the output. Note the pairing of <code>ZomeApiResult&lt;String&gt;</code> as the return type.</p>
<p>The name of the function, <code>handle_send_message</code> is the same as the name given as the <code>handler</code> in the <code>define_zome!</code> function declaration.</p>
<p>Within the function, <code>handle_send_message</code> makes use of a Holochain/HDK function that <a href="https://developer.holochain.org/api/0.0.3/hdk/api/fn.send.html">sends messages directly node-to-node</a>.</p>
<p>The available functions, their purpose, and how to use them is fully documented elsewhere, in the <a href="https://developer.holochain.org/api/0.0.3/hdk/api/index.html#functions">API reference</a> and the <a href="./api_functions.html">List of API Functions</a>.</p>
<p>In the example, <code>handle_send_message</code> simply forwards the result of calling <code>hdk::send</code> as its' own result.</p>
<p>Here are the above two steps combined:</p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
...

fn handle_send_message(to_agent: Address, message: String) -&gt; ZomeApiResult&lt;String&gt;  {
    hdk::send(to_agent, message, 60000.into())
}

define_zome! {
    ...
    functions: [
        send_message: {
            inputs: |to_agent: Address, message: String|,
            outputs: |response: ZomeApiResult&lt;String&gt;|,
            handler: handle_send_message
        }
    ]
}
#}</code></pre></pre>
<p>To see plenty of examples of adding functions, check out a file used for <a href="https://github.com/holochain/holochain-rust/blob/v0.0.3/hdk-rust/wasm-test/src/lib.rs">testing the many capacities of the HDK</a>.</p>
<a class="header" href="#adding-traits" id="adding-traits"><h3>Adding Traits:</h3></a>
<p>Here are some sample traits</p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
...

define_zome! {
    ...
    traits: {
        hc_public [read_post]
        authoring [create_post, update_post]
        }
    }
}
#}</code></pre></pre>
<p>In this example, <code>hc_public</code> is the reserved trait name which create a <code>Public</code> Capbility-type grant at genesis time for access to the <code>read_post</code> function.  Additionally it names an <code>authoring</code> trait the <code>create_post</code> and <code>update_post</code> functions.</p>
<p>Continue reading to learn all about the API Functions and examples of how to use them.</p>

                        <hr />
                        <a href="https://github.com/holochain/holochain-rust/edit/develop/doc/holochain_101/src/zome/zome_functions.md">suggest an edit</a>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../zome/genesis.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../zome/capabilities.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="../zome/genesis.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="../zome/capabilities.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
